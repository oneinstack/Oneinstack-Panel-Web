<template>
    <template v-if="conf.show">
        <Teleport :to="to">
            <transition name="v-mask">
                <div
                    v-if="show"
                    :id="conf.id"
                    class="v-mask"
                    :class="[to !== 'body' ? (box !== null ? 'v-mask-box' : '') : '']"
                    :style="{ backgroundColor: mask ? maskBgColor : '', zIndex: zindex }"
                    @click="colse"
                >
                    <div class="v-mask-ctx">
                        <div @click.stop="">
                            <slot />
                        </div>
                    </div>
                </div>
            </transition>
        </Teleport>
    </template>
</template>

<script lang="ts" setup>
import { onMounted, reactive } from 'vue'

const zindex = VConf.zindex.mask

const props = defineProps({
    /**
     * 是否显示
     */
    show: { default: false },
    /**
     * 开启背景色
     */
    mask: { default: true },
    /**
     * 背景色
     */
    maskBgColor: { default: 'rgba(0, 0, 0, 0.5)' },
    /**
     * 是否可以点击背景关闭
     */
    closemask: { default: true },
    /**
     * 放置位置
     */
    to: { default: 'body' },
    /**
     * 是否是布局显示，默认是全屏
     */
    box: { default: null as any }
})

const emit = defineEmits(['update:show'])
const colse = () => {
    if (props.closemask) emit('update:show', false)
}

const conf = reactive({
    show: false,
    id: 'v-mask-' + StrUtil.getId()
})
onMounted(() => {
    conf.show = true
})
</script>
