import{_ as s}from"./custom-dialog-DSPOWQq5.js";/* empty css             */import{E as e}from"./el-input-CCiT4Pw-.js";import"./el-button-C6SlJWJv.js";/* empty css                        */import"./el-popper-CgqLQvxz.js";import{a as l,b as t,E as a}from"./el-dropdown-item-Dl8qfR11.js";import{_ as o}from"./empty-Ckx_bKPU.js";import{_ as i,a as n}from"./custom-form.vue_vue_type_script_setup_true_lang-GSSM9JND.js";import{A as r}from"./Api-BE344Hwh.js";import{d as p,s as u,x as m,aL as c,b as d,o as v,X as f,a3 as j,J as _,a5 as g,i as y,ae as h,$ as k,n as w,Z as b,h as x,F as C,e as V,t as A}from"./index-B0-DY18Y.js";import{_ as U}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-dialog-DHwsIdVc.js";import"./index-B8-5ocmZ.js";import"./vnode-C-JGoUos.js";import"./index-DSCusJxK.js";import"./el-overlay-n5HYZiIu.js";import"./index-DxVUW8ik.js";import"./refs-CtMAnl62.js";import"./castArray-DHQk_f1a.js";import"./el-drawer-qVVuOe4K.js";import"./el-form-item-DBl2iH2x.js";import"./_Uint8Array-D0RYPAnJ.js";import"./_initCloneObject-B_s4quhu.js";import"./file-panel.vue_vue_type_script_setup_true_lang-DXqMVLax.js";/* empty css                   */import"./el-checkbox-DQDwETtM.js";import"./isEqual-C6HWhcNO.js";import"./el-select-Diq8nzxA.js";import"./index-C1yhuRum.js";/* empty css                          */const q={class:"list"},E={class:"item"},N={style:{padding:"28px 26px"}},S={class:"sundry"},$={class:"icon"},F=["src"],I={class:"content"},J={class:"menuTitle"},L={key:0,class:"remark"},O=["onClick"],T={class:"tip"},X={class:"below"},Z={class:"flex items-center",style:{color:"var(--font-color-gray-light)"}},M=["onClick"],P={key:1,class:"no-data"},Q=U(p({__name:"all",props:{list:{default:()=>[]}},emits:["refresh"],setup(p,{emit:U}){const Q=U,R=u(null),W=m({show:!1,title:"安装",onClose:()=>{var s,e;null==(s=R.value)||s.clearValidate(),null==(e=R.value)||e.resetFields(),W.show=!1},onConfirm:()=>{var s;null==(s=R.value)||s.validate((s=>{s&&(B(),W.show=!1)}))}}),Y=m({value:{key:"",version:""},items:[]}),z=(s,e)=>{Y.value.key=e.key,Y.value.version=s},B=async()=>{const{data:s}=await r.installSoft(Y.value);H(s.installName)},D=m({show:!1,content:"",onClose:()=>{G&&G.clear(),Q("refresh")}}),G=c.Scope.Timer(),H=async s=>{D.show=!0,G.on((async()=>{const{data:e}=await r.getInstallLog({fn:s});D.content=e.logs}),2e3,!0)};return(r,p)=>{const u=C,m=t,c=l,U=a,Q=e,G=s;return v(),d("div",null,[p[5]||(p[5]=f("div",{class:"title"},"应用",-1)),f("div",q,[r.list.length?(v(!0),d(_,{key:0},g(r.list,(s=>(v(),d("div",E,[f("div",N,[f("div",S,[f("div",$,[f("img",{src:s.icon,alt:""},null,8,F)]),f("div",I,[f("div",null,[f("span",J,k(s.name),1),s.tags?(v(),d("span",L,"（"+k(s.tags)+"）",1)):h("",!0),0!==s.status?(v(),d("span",{key:1,class:w(["status ml-2",{error:3===s.status,success:2===s.status,installing:1===s.status}]),onClick:e=>H(s.log)},k(1===s.status?"安装中":2===s.status?"已安装":"安装失败"),11,O)):h("",!0)]),f("div",T,k(s.describe),1)])]),p[3]||(p[3]=f("div",{class:"xian"},null,-1)),f("div",X,[f("div",null,[j(U,{disabled:!(s.versions.length>1)},{dropdown:y((()=>[j(c,null,{default:y((()=>[(v(!0),d(_,null,g(s.versions,((e,l)=>(v(),x(m,{key:l,onClick:l=>z(e,s)},{default:y((()=>[b(k(e),1)])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),default:y((()=>[f("span",Z,[p[2]||(p[2]=f("span",null,"安装版本：",-1)),b(" "+k(Y.value.key===s.key?Y.value.version:s.versions[0])+" ",1),s.versions.length>1?(v(),x(u,{key:0,class:"el-icon--right"},{default:y((()=>[j(V(A))])),_:1})):h("",!0)])])),_:2},1032,["disabled"])]),f("div",{class:w(["btn",{installed:s.installed}]),onClick:e=>(s=>{if(""!=Y.value.version&&s&&s.versions&&s.versions.includes(Y.value.version)?z(Y.value.version,s):z(s.versions[0],s),!s.params)return B();const e=JSON.parse(s.params);Y.items=e.map((s=>({label:s.name,type:"input",prop:s.key,rules:[{required:"true"===s.required,message:`请输入${s.name}`,trigger:"blur"}]}))),W.show=!0})(s)},k(s.installed?"已安装":"安装"),11,M)])])])))),256)):(v(),d("div",P,p[4]||(p[4]=[f("img",{src:o,alt:""},null,-1),f("span",null,"暂无应用",-1)])))]),j(n,{visible:W.show,title:W.title,"on-close":W.onClose,"on-confirm":W.onConfirm},{default:y((()=>[j(i,{data:Y,"on-init":s=>R.value=s},null,8,["data","on-init"])])),_:1},8,["visible","title","on-close","on-confirm"]),j(G,{show:D.show,"onUpdate:show":p[1]||(p[1]=s=>D.show=s),title:"安装日志","on-close":D.onClose},{default:y((()=>[j(Q,{modelValue:D.content,"onUpdate:modelValue":p[0]||(p[0]=s=>D.content=s),type:"textarea",readonly:"",style:{"min-height":"200px"}},null,8,["modelValue"])])),_:1},8,["show","on-close"])])}}}),[["__scopeId","data-v-216cc666"]]);export{Q as default};
