import{_ as e}from"./custom-dialog-DSPOWQq5.js";/* empty css             */import{E as a}from"./el-alert-BsCz6eZd.js";import{_ as t,a as o}from"./custom-form.vue_vue_type_script_setup_true_lang-GSSM9JND.js";import{E as l}from"./el-input-CCiT4Pw-.js";import{E as r,a as i}from"./el-select-Diq8nzxA.js";import"./el-popper-CgqLQvxz.js";import{E as s}from"./el-space-D4lKLniW.js";import{E as d}from"./el-button-C6SlJWJv.js";import{S as p}from"./search-input-ByDnE0bW.js";import{d as n,x as m,c as u,al as c,b as g,o as b,a3 as w,X as f,i as h,Z as v,e as _,aG as y,ag as j,h as x,ae as k}from"./index-B0-DY18Y.js";import{C}from"./card-tabs-CZomr6Jn.js";import{_ as D}from"./custom-table.vue_vue_type_script_setup_true_lang-Sl4-m6yg.js";import{A as V}from"./Api-BE344Hwh.js";import{_ as A}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-dialog-DHwsIdVc.js";import"./index-B8-5ocmZ.js";import"./vnode-C-JGoUos.js";import"./index-DSCusJxK.js";import"./el-overlay-n5HYZiIu.js";import"./index-DxVUW8ik.js";import"./refs-CtMAnl62.js";import"./el-drawer-qVVuOe4K.js";import"./el-form-item-DBl2iH2x.js";import"./castArray-DHQk_f1a.js";import"./_Uint8Array-D0RYPAnJ.js";import"./_initCloneObject-B_s4quhu.js";import"./file-panel.vue_vue_type_script_setup_true_lang-DXqMVLax.js";/* empty css                   */import"./el-checkbox-DQDwETtM.js";import"./isEqual-C6HWhcNO.js";import"./index-C1yhuRum.js";/* empty css                          */import"./el-pagination-BAvsU8LK.js";import"./el-table-column-DufQ25bx.js";import"./el-tooltip-l0sNRNKZ.js";const z={class:"website-container"},U={class:"tool-bar"},$={class:"demo-form-inline"},E={class:"box2"},I=A(n({__name:"index",setup(n){const A=m({tabs:{activeIndex:0,list:[{name:"PHP项目",index:0,value:"php"},{name:"反向代理",index:5,value:"proxy"},{name:"HTML项目",index:6,value:"static"}],clickActive:e=>{A.tabs.activeIndex=e.index,A.website.params.type=e.value,A.website.getData()}},website:{data:[],total:0,columns:[{prop:"name",label:"网站名",width:200},{prop:"domain",label:"域名",width:200},{prop:"root_dir",label:"根目录"},{prop:"remark",label:"备注",width:200},{prop:"action",label:"操作"}],params:{type:"php",page:1,pageSize:10},loading:!0,getData:async()=>{A.website.loading=!0;const{data:e}=await V.getWebsiteList(A.website.params);A.website.loading=!1,A.website.total=e.total,A.website.data=e.data},handleAdd:()=>{A.drawer.open("add"),A.form.data.value.type=A.website.params.type}},drawer:{show:!1,title:"创建网站",type:"add",loading:!1,open:(e,a)=>{var t;if(A.drawer.title="创建网站",A.drawer.type=e,"edit"===e){A.drawer.title="设置网站";const e=structuredClone(c(a)),o=null==(t=e.domain)?void 0:t.split(",");A.form.data.value=e,A.form.data.value.hostDomain=o[0],o.shift(),A.form.data.value.otherDomain=o.join("\n")}A.drawer.show=!0},onConfirm:()=>{var e;null==(e=A.form.instance)||e.validate((async e=>{var a;if(!e)return;const t=null==(a=A.form.data.value.otherDomain)?void 0:a.split("\n");A.form.data.value.domain=t?`${A.form.data.value.hostDomain},${t}`:A.form.data.value.hostDomain,A.drawer.loading=!0;const o="add"===A.drawer.type?V.addWebsite:V.updateWebsite;await o(A.form.data.value),A.drawer.loading=!1,A.drawer.show=!1,A.website.getData()}))},onClose:()=>{var e,a;A.form.data.value={},null==(e=A.form.instance)||e.resetFields(),null==(a=A.form.instance)||a.clearValidate(),A.drawer.show=!1}},form:{instance:null,data:{value:{},items:u((()=>{switch(A.website.params.type){case"php":case"static":return[{label:"主域名",type:"input",placeholder:"支持域名:端口",prop:"hostDomain",rules:[{required:!0,message:"请输入主域名",trigger:"blur"},{pattern:/^([0-9a-zA-Z-]{1,}\.)+([a-zA-Z]{2,})(\:\d{2,})?$/,message:"域名格式错误",trigger:"blur"}]},{label:"其他域名",type:"textarea",placeholder:'一行一个域名，支持*和IP地址，支持"域名:端口"',prop:"otherDomain"},{label:"根目录",type:"input",prop:"root_dir",rules:[{required:!0,message:"请选择根目录",trigger:"blur"},{pattern:/^\/(?:[^/]+\/)*[^/]+$/,message:"路径格式错误"}]},{label:"备注",type:"textarea",prop:"remark"}];case"proxy":return A.form.data.value.pact="http",A.form.data.value.tar_url="$http_host",[{label:"主域名",type:"input",placeholder:"支持域名:端口",prop:"hostDomain",rules:[{required:!0,message:"请输入主域名",trigger:"blur"},{pattern:/^([0-9a-zA-Z-]{1,}\.)+([a-zA-Z]{2,})$/,message:"域名格式错误",trigger:"blur"}]},{label:"其他域名",type:"textarea",placeholder:'一行一个域名，支持*和IP地址，支持"域名:端口"',prop:"otherDomain"},{label:"代理地址",type:"custom",placeholder:"例：127.0.0.1:8080",prop:"send_url",rules:[{required:!0,message:"请输入代理地址",trigger:"blur"}]},{label:"备注",type:"textarea",prop:"remark"}];default:return[]}}))}},dialog:{show:!1,title:"网站删除确认",type:"delete",row:{},open:(e,a)=>{if(A.dialog.type=e,A.dialog.row=a,"delete"===e)A.dialog.title="网站删除确认";A.dialog.show=!0},close:()=>{A.dialog.show=!1},confirm:async()=>{await V.delWebsite({id:A.dialog.row.id}),A.website.getData(),A.dialog.show=!1}}});return A.website.getData(),(n,m)=>{const u=d,c=s,V=i,I=r,Z=l,q=t,P=o,S=a,W=e;return b(),g("div",z,[w(C,{list:A.tabs.list,"active-index":A.tabs.activeIndex,"click-active":A.tabs.clickActive},null,8,["list","active-index","click-active"]),f("div",U,[w(c,{class:"btn-group",size:14},{default:h((()=>[w(u,{type:"primary",onClick:A.website.handleAdd},{default:h((()=>m[7]||(m[7]=[v("添加站点")]))),_:1},8,["onClick"])])),_:1}),f("div",$,[w(p,{modelValue:A.website.params.name,"onUpdate:modelValue":m[0]||(m[0]=e=>A.website.params.name=e),placeholder:"请输入域名",style:{"margin-right":"18px"},onSearch:m[1]||(m[1]=e=>A.website.getData())},null,8,["modelValue"]),w(u,{icon:_(y),type:"primary",onClick:m[2]||(m[2]=e=>A.website.getData())},null,8,["icon"]),w(u,{icon:_(j),type:"primary"},null,8,["icon"])])]),f("div",E,[w(D,{page:A.website.params.page,"onUpdate:page":[m[3]||(m[3]=e=>A.website.params.page=e),A.website.getData],loading:A.website.loading,data:A.website.data,columns:A.website.columns,"auto-pagination":!1,total:A.website.total,"page-size":A.website.params.pageSize},{action:h((({row:e})=>[w(u,{type:"primary",link:"",onClick:a=>A.drawer.open("edit",e)},{default:h((()=>m[8]||(m[8]=[v("设置")]))),_:2},1032,["onClick"]),w(u,{type:"danger",link:"",onClick:a=>A.dialog.open("delete",e)},{default:h((()=>m[9]||(m[9]=[v("删除")]))),_:2},1032,["onClick"])])),_:1},8,["page","loading","data","columns","total","page-size","onUpdate:page"])]),w(P,{visible:A.drawer.show,title:A.drawer.title,loading:A.drawer.loading,"on-close":A.drawer.onClose,"on-confirm":A.drawer.onConfirm},{default:h((()=>[A.drawer.show?(b(),x(q,{key:0,data:A.form.data,"on-init":e=>A.form.instance=e},{send_url:h((({row:e})=>[w(Z,{modelValue:A.form.data.value.send_url,"onUpdate:modelValue":m[5]||(m[5]=e=>A.form.data.value.send_url=e),placeholder:e.placeholder},{prepend:h((()=>[w(I,{modelValue:A.form.data.value.pact,"onUpdate:modelValue":m[4]||(m[4]=e=>A.form.data.value.pact=e),style:{width:"80px"}},{default:h((()=>[w(V,{label:"http",value:"http://"}),w(V,{label:"https",value:"https://"})])),_:1},8,["modelValue"])])),_:2},1032,["modelValue","placeholder"])])),_:1},8,["data","on-init"])):k("",!0)])),_:1},8,["visible","title","loading","on-close","on-confirm"]),w(W,{modelValue:A.dialog.show,"onUpdate:modelValue":m[6]||(m[6]=e=>A.dialog.show=e),title:A.dialog.title},{footer:h((()=>[w(u,{onClick:A.dialog.close},{default:h((()=>m[10]||(m[10]=[v("取消")]))),_:1},8,["onClick"]),w(u,{type:"primary",onClick:A.dialog.confirm},{default:h((()=>m[11]||(m[11]=[v("确认")]))),_:1},8,["onClick"])])),default:h((()=>["delete"===A.dialog.type?(b(),x(S,{key:0,title:"确定删除所选网站？",type:"warning","show-icon":"",closable:!1})):k("",!0)])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-dfd6d456"]]);export{I as default};
