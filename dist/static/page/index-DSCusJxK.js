import{aS as e,aZ as t,s as n,B as o,C as s,E as r,_ as a,d as u,r as d,y as i,e as c,Q as l,V as f,G as p,z as v,p as m,R as E,h as b,o as y,bz as h,g as T}from"./index-B0-DY18Y.js";function w(e){return void 0===e}let L;const g=t=>{var n;if(!e)return 0;if(void 0!==L)return L;const o=document.createElement("div");o.className=`${t}-scrollbar__wrap`,o.style.visibility="hidden",o.style.width="100px",o.style.position="absolute",o.style.top="-9999px",document.body.appendChild(o);const s=o.offsetWidth;o.style.overflow="scroll";const r=document.createElement("div");r.style.width="100%",o.appendChild(r);const a=r.offsetWidth;return null==(n=o.parentNode)||n.removeChild(o),L=s-a,L};function x(t,n){if(!e)return;if(!n)return void(t.scrollTop=0);const o=[];let s=n.offsetParent;for(;null!==s&&t!==s&&t.contains(s);)o.push(s),s=s.offsetParent;const r=n.offsetTop+o.reduce(((e,t)=>e+t.offsetTop),0),a=r+n.offsetHeight,u=t.scrollTop,d=u+t.clientHeight;r<u?t.scrollTop=r:a>d&&(t.scrollTop=a-t.clientHeight)}const A=e=>Array.from(e.querySelectorAll('a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])')).filter((e=>N(e)&&(e=>"fixed"!==getComputedStyle(e).position&&null!==e.offsetParent)(e))),N=e=>{if(e.tabIndex>0||0===e.tabIndex&&null!==e.getAttribute("tabIndex"))return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||"true"===e.getAttribute("aria-disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return!("hidden"===e.type||"file"===e.type);case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},S=function(e,t,...n){let o;o=t.includes("mouse")||t.includes("click")?"MouseEvents":t.includes("key")?"KeyboardEvent":"HTMLEvents";const s=document.createEvent(o);return s.initEvent(t,...n),e.dispatchEvent(s),e},k="focus-trap.focus-after-trapped",P="focus-trap.focus-after-released",R={cancelable:!0,bubbles:!1},I={cancelable:!0,bubbles:!1},_="focusAfterTrapped",C="focusAfterReleased",F=Symbol("elFocusTrap"),K=n(),H=n(0),O=n(0);let B=0;const j=e=>{const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0||e===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t},q=(e,t)=>{for(const n of e)if(!M(n,t))return n},M=(e,t)=>{if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1},U=(e,n)=>{if(e&&e.focus){const o=document.activeElement;let s=!1;!t(e)||N(e)||e.getAttribute("tabindex")||(e.setAttribute("tabindex","-1"),s=!0),e.focus({preventScroll:!0}),O.value=window.performance.now(),e!==o&&(e=>e instanceof HTMLInputElement&&"select"in e)(e)&&n&&e.select(),t(e)&&s&&e.removeAttribute("tabindex")}};function W(e,t){const n=[...e],o=e.indexOf(t);return-1!==o&&n.splice(o,1),n}const $=(()=>{let e=[];return{push:t=>{const n=e[0];n&&t!==n&&n.pause(),e=W(e,t),e.unshift(t)},remove:t=>{var n,o;e=W(e,t),null==(o=null==(n=e[0])?void 0:n.resume)||o.call(n)}}})(),D=()=>{K.value="pointer",H.value=window.performance.now()},z=()=>{K.value="keyboard",H.value=window.performance.now()},G=e=>new CustomEvent("focus-trap.focusout-prevented",{...I,detail:e});let Q=[];const V=e=>{e.code===r.esc&&Q.forEach((t=>t(e)))};var X=a(u({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[_,C,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:a}){const u=n();let d,m;const{focusReason:E}=(o((()=>{0===B&&(document.addEventListener("mousedown",D),document.addEventListener("touchstart",D),document.addEventListener("keydown",z)),B++})),s((()=>{B--,B<=0&&(document.removeEventListener("mousedown",D),document.removeEventListener("touchstart",D),document.removeEventListener("keydown",z))})),{focusReason:K,lastUserFocusTimestamp:H,lastAutomatedFocusTimestamp:O});var b;b=e=>{t.trapped&&!y.paused&&a("release-requested",e)},o((()=>{0===Q.length&&document.addEventListener("keydown",V),e&&Q.push(b)})),s((()=>{Q=Q.filter((e=>e!==b)),0===Q.length&&e&&document.removeEventListener("keydown",V)}));const y={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},h=e=>{if(!t.loop&&!t.trapped)return;if(y.paused)return;const{code:n,altKey:o,ctrlKey:s,metaKey:u,currentTarget:d,shiftKey:i}=e,{loop:c}=t,l=n===r.tab&&!o&&!s&&!u,f=document.activeElement;if(l&&f){const t=d,[n,o]=(e=>{const t=j(e);return[q(t,e),q(t.reverse(),e)]})(t);if(n&&o)if(i||f!==o){if(i&&[n,t].includes(f)){const t=G({focusReason:E.value});a("focusout-prevented",t),t.defaultPrevented||(e.preventDefault(),c&&U(o,!0))}}else{const t=G({focusReason:E.value});a("focusout-prevented",t),t.defaultPrevented||(e.preventDefault(),c&&U(n,!0))}else if(f===t){const t=G({focusReason:E.value});a("focusout-prevented",t),t.defaultPrevented||e.preventDefault()}}};v(F,{focusTrapRef:u,onKeydown:h}),i((()=>t.focusTrapEl),(e=>{e&&(u.value=e)}),{immediate:!0}),i([u],(([e],[t])=>{e&&(e.addEventListener("keydown",h),e.addEventListener("focusin",L),e.addEventListener("focusout",g)),t&&(t.removeEventListener("keydown",h),t.removeEventListener("focusin",L),t.removeEventListener("focusout",g))}));const T=e=>{a(_,e)},w=e=>a(C,e),L=e=>{const n=c(u);if(!n)return;const o=e.target,s=e.relatedTarget,r=o&&n.contains(o);if(!t.trapped){s&&n.contains(s)||(d=s)}r&&a("focusin",e),y.paused||t.trapped&&(r?m=o:U(m,!0))},g=e=>{const n=c(u);if(!y.paused&&n)if(t.trapped){const o=e.relatedTarget;l(o)||n.contains(o)||setTimeout((()=>{if(!y.paused&&t.trapped){const e=G({focusReason:E.value});a("focusout-prevented",e),e.defaultPrevented||U(m,!0)}}),0)}else{const t=e.target;t&&n.contains(t)||a("focusout",e)}};async function x(){await f();const e=c(u);if(e){$.push(y);const n=e.contains(document.activeElement)?d:document.activeElement;d=n;if(!e.contains(n)){const o=new Event(k,R);e.addEventListener(k,T),e.dispatchEvent(o),o.defaultPrevented||f((()=>{let o=t.focusStartEl;p(o)||(U(o),document.activeElement!==o&&(o="first")),"first"===o&&((e,t=!1)=>{const n=document.activeElement;for(const o of e)if(U(o,t),document.activeElement!==n)return})(j(e),!0),document.activeElement!==n&&"container"!==o||U(e)}))}}}function A(){const e=c(u);if(e){e.removeEventListener(k,T);const t=new CustomEvent(P,{...R,detail:{focusReason:E.value}});e.addEventListener(P,w),e.dispatchEvent(t),t.defaultPrevented||"keyboard"!=E.value&&H.value>O.value&&!e.contains(document.activeElement)||U(null!=d?d:document.body),e.removeEventListener(P,w),$.remove(y)}}return o((()=>{t.trapped&&x(),i((()=>t.trapped),(e=>{e?x():A()}))})),s((()=>{t.trapped&&A(),u.value&&(u.value.removeEventListener("keydown",h),u.value.removeEventListener("focusin",L),u.value.removeEventListener("focusout",g),u.value=void 0)})),{onKeydown:h}}}),[["render",function(e,t,n,o,s,r){return d(e.$slots,"default",{handleKeydown:e.onKeydown})}],["__file","focus-trap.vue"]]);const Z=T(a(u({__name:"teleport",props:m({to:{type:E([String,Object]),required:!0},disabled:Boolean}),setup:e=>(e,t)=>e.disabled?d(e.$slots,"default",{key:0}):(y(),b(h,{key:1,to:e.to},[d(e.$slots,"default")],8,["to"]))}),[["__file","teleport.vue"]]));export{X as E,F,w as a,Z as b,U as c,g,N as i,A as o,x as s,S as t};
