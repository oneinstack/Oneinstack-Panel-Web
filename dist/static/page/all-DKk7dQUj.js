/* empty css             *//* empty css                 */import{_ as e}from"./custom-dialog-BxqsFKc1.js";/* empty css                  */import"./el-tag-yAT8BjOt.js";import{E as s,a as l}from"./el-select-Bwq_6nmq.js";import"./el-popper-B255Np42.js";/* empty css                        */import{E as o}from"./el-dropdown-Z3XfnFo5.js";import{_ as a}from"./empty-58wIjZM8.js";import{_ as t,a as i}from"./custom-form.vue_vue_type_script_setup_true_lang-CAzyHkDW.js";import{A as n}from"./Api-D-M6Obau.js";import{d as r,s as u,x as m,aL as p,b as d,o as c,X as v,a3 as f,J as j,a5 as y,i as h,h as g,Z as w,a4 as k,$ as _,n as b,a1 as x}from"./index-BJjfPnyH.js";import{E as C}from"./index-BRUeVUFU.js";import{E as V}from"./index-CXS_p1oq.js";import{_ as I}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-dialog-DILa8Wz7.js";import"./index-BWcw6JbV.js";import"./vnode-xBXC_NUn.js";import"./index-DE8f9FJy.js";import"./scroll-CPnK1sXk.js";import"./index-BQE0cEfW.js";import"./el-overlay-BTuoOT1q.js";import"./index-DLfiFkmB.js";import"./_Uint8Array-Ik12j-RK.js";import"./isEqual-Ai17W6Q8.js";import"./castArray-DWWiYOsI.js";import"./el-drawer-DmnWQlXU.js";import"./el-form-item-CgmraheN.js";import"./_initCloneObject-MiKUVYQK.js";import"./file-panel-Df9AY8zl.js";/* empty css                   */import"./el-checkbox-CrPCccUF.js";import"./index-cGrDTBC5.js";/* empty css                          */const S={class:"list"},U={class:"item"},E={style:{padding:"28px 26px"}},N={class:"sundry"},O={class:"icon"},q=["src"],A={class:"content"},J={class:"menuTitle"},T={key:0,class:"remark"},$={class:"tip"},L={class:"below"},X={class:"flex items-center",style:{color:"var(--font-color-gray-light)"}},Z=["onClick"],F={key:1,class:"no-data"},R={class:"version-select-container"},W=I(r({__name:"all",props:{list:{default:()=>[]}},emits:["refresh"],setup(r,{emit:I}){const W=I,Y=u(null),z=m({show:!1,title:"安装",onClose:()=>{var e,s;null==(e=Y.value)||e.clearValidate(),null==(s=Y.value)||s.resetFields(),z.show=!1},onConfirm:()=>{var e;null==(e=Y.value)||e.validate((e=>{e&&(M(),z.show=!1)}))}}),B=m({value:{key:"",version:""},items:[]}),D=m({show:!1,currentItem:null,onClose:()=>{D.show=!1,D.currentItem=null},onConfirm:()=>{D.show=!1,G(D.currentItem)}}),G=e=>{if(""!=B.value.version&&e&&e.versions&&e.versions.includes(B.value.version)?H(B.value.version,e):H(e.versions[0],e),!e.params)return M();const s=JSON.parse(e.params);B.items=s.map((e=>({label:e.name,type:"input",prop:e.key,rules:[{required:"true"===e.required,message:`请输入${e.name}`,trigger:"blur"}]}))),z.show=!0},H=(e,s)=>{B.value.key=s.key,B.value.version=e},K=u(JSON.parse(localStorage.getItem("installedVersions")||"{}")),M=async()=>{const{data:e}=await n.installSoft(B.value);K.value[B.value.key]=B.value.version,localStorage.setItem("installedVersions",JSON.stringify(K.value)),ee(e.installName)},P=m({show:!1,content:"",onClose:()=>{Q&&Q.clear(),W("refresh")}}),Q=p.Scope.Timer(),ee=async e=>{P.show=!0,Q.on((async()=>{const{data:s}=await n.getInstallLog({fn:e});P.content=s.logs}),2e3,!0)};return(n,r)=>{const u=o,m=l,p=s,I=C,W=e,H=V;return c(),d("div",null,[r[10]||(r[10]=v("div",{class:"title"},"应用",-1)),v("div",S,[n.list.length?(c(!0),d(j,{key:0},y(n.list,(e=>(c(),d("div",U,[v("div",E,[v("div",N,[v("div",O,[v("img",{src:e.icon,alt:""},null,8,q)]),v("div",A,[v("div",null,[v("span",J,_(e.name),1),e.tags?(c(),d("span",T,"（"+_(e.tags)+"）",1)):k("",!0)]),v("div",$,_(e.describe),1)])]),r[5]||(r[5]=v("div",{class:"xian"},null,-1)),v("div",L,[v("div",null,[f(u,{disabled:!(e.versions.length>1)},{default:h((()=>[v("span",X,[0===e.status?(c(),d(j,{key:0},[w(" 未安装 ")],64)):(c(),d(j,{key:1},[r[4]||(r[4]=v("span",null,"已安装版本：",-1)),w(" "+_(K.value[e.key]),1)],64))])])),_:2},1032,["disabled"])]),v("div",{class:b(["btn",{installed:2===e.status||K.value[e.key],uninstall:2===e.status||K.value[e.key]}]),onClick:s=>2===e.status||K.value[e.key]?void x({type:"warning",message:"卸载功能开发中..."}):(e=>{e.versions.length>1?(D.currentItem=e,D.show=!0):G(e)})(e)},_(2===e.status||K.value[e.key]?"卸载":"安装"),11,Z)])])])))),256)):(c(),d("div",F,r[6]||(r[6]=[v("img",{src:a,alt:""},null,-1),v("span",null,"暂无应用",-1)])))]),f(i,{visible:z.show,title:z.title,"on-close":z.onClose,"on-confirm":z.onConfirm},{default:h((()=>[f(t,{data:B,"on-init":e=>Y.value=e},null,8,["data","on-init"])])),_:1},8,["visible","title","on-close","on-confirm"]),f(W,{show:D.show,"onUpdate:show":r[1]||(r[1]=e=>D.show=e),title:"版本选择","on-close":D.onClose},{footer:h((()=>[f(I,{onClick:D.onClose},{default:h((()=>r[8]||(r[8]=[w("取消")]))),_:1},8,["onClick"]),f(I,{type:"primary",onClick:D.onConfirm},{default:h((()=>r[9]||(r[9]=[w("安装")]))),_:1},8,["onClick"])])),default:h((()=>[v("div",R,[r[7]||(r[7]=v("div",{class:"version-label"},"版本",-1)),f(p,{modelValue:B.value.version,"onUpdate:modelValue":r[0]||(r[0]=e=>B.value.version=e),placeholder:"请选择版本",style:{width:"100%"},"popper-class":"version-select-dropdown"},{default:h((()=>{var e;return[(c(!0),d(j,null,y(null==(e=D.currentItem)?void 0:e.versions,(e=>(c(),g(m,{key:e,label:e,value:e},null,8,["label","value"])))),128))]})),_:1},8,["modelValue"])])])),_:1},8,["show","on-close"]),f(W,{show:P.show,"onUpdate:show":r[3]||(r[3]=e=>P.show=e),title:"安装日志","on-close":P.onClose},{default:h((()=>[f(H,{modelValue:P.content,"onUpdate:modelValue":r[2]||(r[2]=e=>P.content=e),type:"textarea",readonly:"",style:{"min-height":"200px"}},null,8,["modelValue"])])),_:1},8,["show","on-close"])])}}}),[["__scopeId","data-v-4a9bd10a"]]);export{W as default};
