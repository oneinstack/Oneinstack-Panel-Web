/* empty css             *//* empty css                 */import{_ as e}from"./custom-dialog-C2QYRSKW.js";/* empty css                  */import"./el-tag-Dxm_Axr8.js";import{E as s,a as l}from"./el-select-Bf0uoiH2.js";import"./el-popper-ClYUeexH.js";import{C as a}from"./custom-table-M46h8iS8.js";import{E as t,a as o}from"./el-link--n5TGvee.js";/* empty css                        */import{_ as i}from"./empty-58wIjZM8.js";import{_ as n,a as r}from"./custom-form.vue_vue_type_script_setup_true_lang-BlN96ovS.js";import{A as u}from"./Api-99phi20S.js";import{d as p,s as m,x as c,aL as d,W as v,b as y,o as f,X as j,a3 as h,e as g,a6 as k,J as w,a5 as b,i as _,$ as C,h as x,Z as V,a1 as I,a4 as S,n as U}from"./index-B5c3jFiu.js";import{E}from"./index-CY3iw2TW.js";import{E as O}from"./index-FXwX-Tc-.js";import{_ as A}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-dialog-C9RVZp-L.js";import"./index-DguJ4OYc.js";import"./vnode-wHVxG6yF.js";import"./index-DwJjVrn6.js";import"./scroll-CGLW73hp.js";import"./index-EHUqHs3S.js";import"./el-overlay-DfJ2upq2.js";import"./index-36sCsZ2B.js";import"./_Uint8Array-D9m7vkXT.js";import"./isEqual-ClYigGjQ.js";import"./castArray-DrYRfuDR.js";/* empty css                   */import"./el-pagination-DKmoe1tS.js";import"./el-table-column-QyJit_Aw.js";import"./_initCloneObject-CUocRwYS.js";import"./el-checkbox-WLPkjpqU.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-drawer-BeOw-O7q.js";import"./el-form-item-ey1Wr8cE.js";import"./file-panel-w5NTE3Ff.js";import"./index-Ca4LNgmQ.js";/* empty css                          */const J={class:"title"},N={key:0,class:"list"},q={class:"item"},L={class:"sundry"},T={class:"icon"},W=["src"],X={class:"content"},Z={class:"menuTitle"},$={key:0,class:"remark"},z={class:"tip"},F={class:"below"},P={class:"flex items-center",style:{color:"var(--font-color-gray-light)"}},Q=["onClick"],Y={key:1,class:"no-data"},B={key:1,class:"table-content"},D={key:0},G={key:1},H={key:2},K=["onClick"],M={class:"version-select-container"},R=A(p({__name:"all",props:{list:{default:()=>[]}},emits:["refresh"],setup(p,{emit:A}){const R=A,ee=m(null),se=c({show:!1,title:"安装",onClose:()=>{var e,s;null==(e=ee.value)||e.clearValidate(),null==(s=ee.value)||s.resetFields(),se.show=!1},onConfirm:()=>{var e;null==(e=ee.value)||e.validate((e=>{e&&(ue(),se.show=!1)}))}}),le=c({value:{key:"",version:""},items:[]}),ae=e=>{I({type:"warning",message:"卸载功能开发中..."})},te=c({show:!1,currentItem:null,onClose:()=>{te.show=!1,te.currentItem=null},onConfirm:()=>{te.show=!1,ie(te.currentItem)}}),oe=e=>{e.versions.length>1?(te.currentItem=e,te.show=!0):ie(e)},ie=e=>{if(""!=le.value.version&&e&&e.versions&&e.versions.includes(le.value.version)?ne(le.value.version,e):ne(e.versions[0],e),!e.params)return ue();const s=JSON.parse(e.params);le.items=s.map((e=>({label:e.name,type:"input",prop:e.key,rules:[{required:"true"===e.required,message:`请输入${e.name}`,trigger:"blur"}]}))),se.show=!0},ne=(e,s)=>{le.value.key=s.key,le.value.version=e},re=m(JSON.parse(localStorage.getItem("installedVersions")||"{}")),ue=async()=>{const{data:e}=await u.installSoft(le.value);re.value[le.value.key]=le.value.version,localStorage.setItem("installedVersions",JSON.stringify(re.value)),ce(e.installName)},pe=c({show:!1,content:"",onClose:()=>{me&&me.clear(),R("refresh")}}),me=d.Scope.Timer(),ce=async e=>{pe.show=!0,me.on((async()=>{const{data:s}=await u.getInstallLog({fn:e});pe.content=s.logs}),2e3,!0)},de=()=>{k.setLayout("grid"==k.layout?"list":"grid")},ve=[{prop:"name",label:"软件名称",width:280},{prop:"describe",label:"简介"},{prop:"status",label:"是否安装",width:180},{prop:"version",label:"安装版本",width:180},{prop:"operation",label:"操作",width:180,align:"center"}];return(u,p)=>{const m=v("v-s-icon"),c=o,d=t,I=a,A=l,R=s,ie=E,ne=e,ue=O;return f(),y("div",null,[j("div",J,[p[4]||(p[4]=j("p",null,"应用",-1)),h(m,{name:"layout",size:"22",class:"cursor-pointer",onClick:de})]),"grid"==g(k).layout?(f(),y("div",N,[u.list.length?(f(!0),y(w,{key:0},b(u.list,(e=>(f(),y("div",q,[j("div",L,[j("div",T,[j("img",{src:e.icon,alt:""},null,8,W)]),j("div",X,[j("div",null,[j("span",Z,C(e.name),1),e.tags?(f(),y("span",$,"（"+C(e.tags)+"）",1)):S("",!0)]),j("div",z,C(e.describe),1)])]),p[6]||(p[6]=j("div",{class:"xian"},null,-1)),j("div",F,[j("div",null,[h(c,{disabled:!(e.versions.length>1)},{default:_((()=>[j("span",P,[0===e.status?(f(),y(w,{key:0},[V(" 未安装 ")],64)):(f(),y(w,{key:1},[p[5]||(p[5]=j("span",null,"已安装版本：",-1)),V(" "+C(re.value[e.key]),1)],64))])])),_:2},1032,["disabled"])]),j("div",{class:U(["btn",{installed:2===e.status||re.value[e.key],uninstall:2===e.status||re.value[e.key]}]),onClick:s=>2===e.status||re.value[e.key]?ae():oe(e)},C(2===e.status||re.value[e.key]?"卸载":"安装"),11,Q)])])))),256)):(f(),y("div",Y,p[7]||(p[7]=[j("img",{src:i,alt:""},null,-1),j("span",null,"暂无应用",-1)])))])):(f(),y("div",B,[h(I,{columns:ve,data:u.list,pagination:!1},{status:_((({row:e})=>[0===e.status?(f(),y("span",D,"未安装")):2===e.status?(f(),y("span",G,"已安装")):(f(),y("span",H,"安装失败"))])),operation:_((({row:e})=>[h(d,{type:2===e.status||re.value[e.key]?"danger":"primary"},{default:_((()=>[j("span",{class:"flex items-center",onClick:s=>2===e.status||re.value[e.key]?ae():oe(e)},C(2===e.status||re.value[e.key]?"卸载":"安装"),9,K)])),_:2},1032,["type"])])),_:1},8,["data"])])),h(r,{visible:se.show,title:se.title,"on-close":se.onClose,"on-confirm":se.onConfirm},{default:_((()=>[h(n,{data:le,"on-init":e=>ee.value=e},null,8,["data","on-init"])])),_:1},8,["visible","title","on-close","on-confirm"]),h(ne,{show:te.show,"onUpdate:show":p[1]||(p[1]=e=>te.show=e),title:"版本选择","on-close":te.onClose},{footer:_((()=>[h(ie,{onClick:te.onClose},{default:_((()=>p[9]||(p[9]=[V("取消")]))),_:1},8,["onClick"]),h(ie,{type:"primary",onClick:te.onConfirm},{default:_((()=>p[10]||(p[10]=[V("安装")]))),_:1},8,["onClick"])])),default:_((()=>[j("div",M,[p[8]||(p[8]=j("div",{class:"version-label"},"版本",-1)),h(R,{modelValue:le.value.version,"onUpdate:modelValue":p[0]||(p[0]=e=>le.value.version=e),placeholder:"请选择版本",style:{width:"100%"},"popper-class":"version-select-dropdown"},{default:_((()=>{var e;return[(f(!0),y(w,null,b(null==(e=te.currentItem)?void 0:e.versions,(e=>(f(),x(A,{key:e,label:e,value:e},null,8,["label","value"])))),128))]})),_:1},8,["modelValue"])])])),_:1},8,["show","on-close"]),h(ne,{show:pe.show,"onUpdate:show":p[3]||(p[3]=e=>pe.show=e),title:"安装日志","on-close":pe.onClose},{default:_((()=>[h(ue,{modelValue:pe.content,"onUpdate:modelValue":p[2]||(p[2]=e=>pe.content=e),type:"textarea",readonly:"",style:{"min-height":"200px"}},null,8,["modelValue"])])),_:1},8,["show","on-close"])])}}}),[["__scopeId","data-v-e9c1436c"]]);export{R as default};
