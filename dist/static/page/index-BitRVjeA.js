import{_ as a,a as e}from"./custom-form.vue_vue_type_script_setup_true_lang-GSSM9JND.js";/* empty css             */import{E as t}from"./el-input-CCiT4Pw-.js";import{E as s,a as r}from"./el-select-Diq8nzxA.js";import"./el-popper-CgqLQvxz.js";import{d as l,x as i,c as o,a1 as p,ab as d,b as n,o as m,a3 as u,a8 as c,i as b,h as g,ae as v}from"./index-B0-DY18Y.js";import{C as f}from"./card-tabs-CZomr6Jn.js";import{A as y}from"./Api-BE344Hwh.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-drawer-qVVuOe4K.js";import"./index-B8-5ocmZ.js";import"./vnode-C-JGoUos.js";import"./index-DSCusJxK.js";import"./el-overlay-n5HYZiIu.js";import"./el-button-C6SlJWJv.js";import"./el-form-item-DBl2iH2x.js";import"./castArray-DHQk_f1a.js";import"./_Uint8Array-D0RYPAnJ.js";import"./_initCloneObject-B_s4quhu.js";import"./custom-dialog-DSPOWQq5.js";import"./el-dialog-DHwsIdVc.js";import"./index-DxVUW8ik.js";import"./refs-CtMAnl62.js";import"./file-panel.vue_vue_type_script_setup_true_lang-DXqMVLax.js";/* empty css                   */import"./el-checkbox-DQDwETtM.js";import"./isEqual-C6HWhcNO.js";import"./index-C1yhuRum.js";/* empty css                          */const j={class:"database-container"},_=w(l({__name:"index",setup(l){var w;const _=i({themeColor:{light:["#F7911C"],dark:["#EAB170"]},showTips:!0,tabs:{activeIndex:0,list:[{name:"MySQL",index:0,value:"mysql"},{name:"Redis",index:3,value:"redis"}],clickActive:a=>{_.tabs.activeIndex!==a.index&&(_.list.params={page:1,pageSize:10,type:"mysql"},_.tabs.activeIndex=a.index,_.list.params.type=a.value,_.form.data.value.type=a.value,_.list.loading=!1,_.list.total=0,_.list.data=[],d.router.push(`/database/${a.value}`))}},list:{loading:!0,data:[],total:0,params:{page:1,pageSize:10,type:"mysql"},columns:o((()=>{switch(_.list.params.type){case"mysql":return[{prop:"name",label:"数据库名"},{prop:"user",label:"用户名"},{prop:"password",label:"密码"},{prop:"capacity",label:"容量",placeholder:"未配置"},{prop:"p_addr",label:"数据库位置"},{prop:"action",label:"操作"}];case"redis":return[{prop:"key",label:"键"},{prop:"type",label:"类型"},{prop:"length",label:"长度"},{prop:"expiration",label:"有效期"}];default:return[]}})),getData:async()=>{_.list.loading=!0;const a="redis"===_.list.params.type?y.getRedisList:y.getDatabaseList,{data:e}=await a(_.list.params);"redis"!==_.list.params.type&&e.data.forEach(((a,e)=>_.password.show[e]=!1)),_.list.loading=!1,_.list.total=e.total,_.list.data=e["redis"===_.list.params.type?"keys":"data"]}},password:{show:{},copy:async a=>{await navigator.clipboard.writeText(a),p.success("复制成功！")}},drawer:{show:!1,title:"添加数据库",type:"add",loading:!1,open:a=>{_.drawer.type=a,_.drawer.show=!0,_.drawer.title="添加数据库"},onClose:()=>{var a,e;null==(a=_.form.instance)||a.clearValidate(),null==(e=_.form.instance)||e.resetFields(),_.drawer.show=!1},onConfirm:()=>{var a;null==(a=_.form.instance)||a.validate((async a=>{a&&(_.drawer.loading=!0,await y.addDatabaseLib(_.form.data.value),_.drawer.loading=!1,p.success("添加成功！"),_.list.getData(),_.drawer.show=!1)}))}},form:{instance:null,data:{value:{encoding:"utf8",type:"mysql"},items:o((()=>"mysql"===_.list.params.type?[{label:"数据库名",prop:"name",type:"custom",rules:[{required:!0,message:"请输入数据库名",trigger:"blur"}]},{label:"用户名",prop:"root",type:"input",rules:[{required:!0,message:"请输入用户名",trigger:"blur"}]},{label:"密码",prop:"password",type:"password",rules:[{required:!0,message:"请输入密码",trigger:"blur"}]},{label:"添加至",prop:"id",asyncOptions:async()=>{const{data:a}=await y.getConnlist(_.list.params);return _.form.data.value.id=a[0].id,a.map((a=>({label:a.remark?`${a.remark}(${a.addr})`:a.addr,value:a.id})))},type:"select",rules:[{required:!0,message:"请选择",trigger:"change"}]}]:[]))}}}),h=null==(w=d.getRouterPath().match(new RegExp("(?<=\\/database\\/)\\w*")))?void 0:w[0];return _.tabs.activeIndex=_.tabs.list.find((a=>a.value===h)).index,_.list.params.type=h,(l,i)=>{const o=c,p=r,d=s,y=t,w=a,h=e;return m(),n("div",j,[u(f,{list:_.tabs.list,"active-index":_.tabs.activeIndex,"click-active":_.tabs.clickActive},null,8,["list","active-index","click-active"]),u(o,{conf:_},null,8,["conf"]),u(h,{visible:_.drawer.show,title:_.drawer.title,loading:_.drawer.loading,"on-close":_.drawer.onClose,"on-confirm":_.drawer.onConfirm},{default:b((()=>["add"===_.drawer.type?(m(),g(w,{key:0,data:_.form.data,"on-init":a=>_.form.instance=a},{name:b((({row:a})=>[u(y,{modelValue:_.form.data.value.name,"onUpdate:modelValue":i[1]||(i[1]=a=>_.form.data.value.name=a),placeholder:a.placeholder},{append:b((()=>[u(d,{modelValue:_.form.data.value.encoding,"onUpdate:modelValue":i[0]||(i[0]=a=>_.form.data.value.encoding=a),style:{width:"120px"}},{default:b((()=>[u(p,{label:"utf8",value:"utf8"}),u(p,{label:"utf8mb4",value:"utf8mb4"}),u(p,{label:"gbk",value:"gbk"}),u(p,{label:"big5",value:"big5"})])),_:1},8,["modelValue"])])),_:2},1032,["modelValue","placeholder"])])),_:1},8,["data","on-init"])):v("",!0)])),_:1},8,["visible","title","loading","on-close","on-confirm"])])}}}),[["__scopeId","data-v-d3f9a464"]]);export{_ as default};
